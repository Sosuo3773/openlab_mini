<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ post.title }} | OpenLab mini</title>
</head>
<body>
  <h1>{{ post.title }}</h1>
  <p><b>カテゴリ:</b> {{ post.category }}</p>
  <p>{{ post.content }}</p>
  <hr>
  <h2>コメント</h2>
  {% for c in comments %}
    {% if not c.parent_id %}
      <div style="margin-left:20px; border:1px solid #ccc; padding:5px;">
        {{ c.content }} <small>({{ c.date.strftime("%Y-%m-%d %H:%M") }})</small>
        <form method="POST">
          <input type="hidden" name="parent_id" value="{{ c.id }}">
          <input name="content" placeholder="返信を書く">
          <button type="submit">返信</button>
        </form>
        {% for r in comments %}
          {% if r.parent_id == c.id %}
            <div style="margin-left:20px; border-left:2px solid #aaa; padding:5px;">
              {{ r.content }} <small>({{ r.date.strftime("%Y-%m-%d %H:%M") }})</small>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  {% endfor %}
  <hr>
  <h3>新しいコメントを追加</h3>
  <form method="POST">
    <textarea name="content" rows="3" cols="50"></textarea><br>
    <button type="submit">送信</button>
  </form>
  <a href="/">← トップへ戻る</a>
</body>
</html>
